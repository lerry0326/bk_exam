webpackJsonp([16],{Q5Ou:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("BO1k"),n=a.n(r),i=a("Xxa5"),s=a.n(i),u=a("//Fk"),o=a.n(u),l=a("exGp"),c=a.n(l),h={data:function(){return{checked:[],activeName:"first",dataMenuTree:[],haveMenuAuthority:[],checkeditem:[],allOperations:[],defaultMenuProps:{children:"children",label:"display_name"}}},created:function(){this.menuAuthority(),this.getPerm()},methods:{allMenu:function(){var e=this;return this.dataMenuTree=[],this.$store.dispatch("leftmenu/getMenuTree").then(function(t){t.result&&(e.dataMenuTree=t.data)})},haveMenu:function(){var e=this;this.haveMenuAuthority=[];var t={id:this.$route.params.group_id};return this.$store.dispatch("group/getAuthority",t).then(function(t){t.result&&(e.haveMenuAuthority=t.data.menus.map(function(e){return e.id}))})},menuAuthority:function(e){var t=this;return c()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.a.all([t.allMenu(),t.haveMenu(e)]);case 2:case"end":return a.stop()}},a,t)}))()},getPerm:function(){var e=this;this.allOperations=[];var t={id:this.$route.params.group_id};this.$store.dispatch("group/getPermsTree",t).then(function(t){t.result&&(e.allOperations=t.data)})},checkConfirm:function(){var e=this,t=this.$refs.tree.getCheckedNodes();t=t.map(function(e){return e.id});var a=[],r=!0,i=!1,s=void 0;try{for(var u,o=n()(this.allOperations);!(r=(u=o.next()).done);r=!0){var l=u.value;if(0!==l.children.length){var c=!0,h=!1,d=void 0;try{for(var p,f=n()(l.children);!(c=(p=f.next()).done);c=!0){var m=p.value;1==m.has_perms&&a.push(m.id)}}catch(e){h=!0,d=e}finally{try{!c&&f.return&&f.return()}finally{if(h)throw d}}}}}catch(e){i=!0,s=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw s}}var v={id:this.$route.params.group_id,permissions:a,menus:t};this.$store.dispatch("group/editGroups",v).then(function(t){t.result?e.$message({type:"success",message:"权限设置成功"}):(e.getPerm(),e.$message({type:"error",message:"权限设置失败"}))})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"permission"},[a("div",{staticClass:"contain"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"菜单权限",name:"first"}},[a("el-tree",{ref:"tree",attrs:{data:e.dataMenuTree,"show-checkbox":"","default-expand-all":"","node-key":"id","highlight-current":"","default-checked-keys":e.haveMenuAuthority,props:e.defaultMenuProps}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"操作权限",name:"second"}},e._l(e.allOperations,function(t,r){return a("div",{key:r,staticClass:"one-layer"},[a("span",{staticClass:"one-layer-name"},[e._v(e._s(t.display_name))]),e._v(" "),e._l(t.children,function(t,r){return a("el-checkbox",{key:r,model:{value:t.has_perms,callback:function(a){e.$set(t,"has_perms",a)},expression:"itemOperation.has_perms"}},[e._v("\n            "+e._s(t.display_name)+"\n          ")])})],2)})),e._v(" "),a("div",{staticClass:"check-confirm"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.checkConfirm}},[e._v("保存")])],1)],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(h,d,!1,function(e){a("VIWI")},null,null);t.default=p.exports},VIWI:function(e,t){}});
//# sourceMappingURL=16.js.map