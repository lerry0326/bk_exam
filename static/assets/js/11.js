webpackJsonp([11],{igjK:function(e,t){},xD9o:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("BO1k"),s=a.n(i),n=a("mvHQ"),o=a.n(n),r=a("cMGX"),l=a("l0np"),c=a("rM4U"),u=(a("CaOM"),{components:{pagination:r.a,"new-edit":l.a},data:function(){return{inputGroup:"",title:"",dialogAction:"",activeName:"first",width:"40%",valueIsBuiltIn:void 0,valueIsEnable:void 0,labelPosition:"right",totalNumber:0,currentPage:1,pageSize:10,loadingGroup:!1,loadingLeft:!1,loadingRight:!1,cacheLeftData:[],cacheRightData:[],data:[],leftData:[],rightData:[],formGroups:{name:"",display_name:"",users:[],desc:""},rulesGroups:{name:[{required:!0,message:"请输入组名"},{max:20,message:"长度在20个字符之内"},{validator:c.c}],display_name:[{required:!0,message:"请输入显示名"},{max:14,message:"长度在14个字符之内"},{validator:c.b}]},optionsIsBuiltIn:[{value:!0,label:"是"},{value:!1,label:"否"}],optionsIsEnable:[{value:!0,label:"是"},{value:!1,label:"否"}]}},created:function(){this.search()},methods:{search:function(){var e=this,t={page:this.currentPage,page_size:this.pageSize,is_built_in:this.valueIsBuiltIn,is_enable:this.valueIsEnable,display_name:this.inputGroup,omit:"menus,permissions"};this.loadingGroup=!0,this.$store.dispatch("group/getGroups",t).then(function(t){t.result&&(e.loadingGroup=!1,e.data=t.data.items,e.totalNumber=t.data.count)})},pageSizeChange:function(e){this.currentPage=e.currentPage,this.pageSize=e.pageSize,this.search({page:this.currentPage,page_size:this.pageSize})},reset:function(){this.inputGroup="",this.valueIsBuiltIn=void 0,this.valueIsEnable=void 0,this.search()},handleEdit:function(e){this.activeName="first",this.dialogAction="edit",this.title="编辑",this.$refs.newEdit.open(),this.formGroups=JSON.parse(o()(e.row)),this.formGroups.users=this.formGroups.users.map(function(e){return e.id}),this.rightData=e.row.users,this.leftData=[],this.getLeftUser()},leaveTab:function(e){var t=!0;return this.$refs.refformGroups.validate(function(e){t=!!e}),t},handleNew:function(){var e=this;this.activeName="first",this.dialogAction="new",this.title="新建",this.$refs.newEdit.open(),this.$nextTick(function(){e.$refs.refformGroups.clearValidate()}),this.leftData=[],this.rightData=[],this.getLeftUser(),this.formGroups={}},checkboxChange:function(e){var t=this,a=e.is_enable?"是否启用":"是否禁用";this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(1==e.is_enable){var a={groups:[e.id],enable:!0};t.$store.dispatch("group/groupsStatus",a).then(function(a){a.result?t.$message({type:"success",message:"禁用成功"}):(e.is_enable=!e.is_enable,t.$message({type:"error",message:"禁用失败"}))})}else if(0==e.is_enable){var i={groups:[e.id],enable:!1};t.$store.dispatch("group/groupsStatus",i).then(function(a){a.result?t.$message({type:"success",message:"启用成功"}):(e.is_enable=!e.is_enable,t.$message({type:"error",message:"启用失败"}))})}}).catch(function(){e.is_enable=!e.is_enable,t.$message({type:"info",message:"调取接口失败"})})},handleAuthority:function(e){this.$router.push(e)},handleSuccess:function(e){var t=this;if("new"==this.dialogAction){var a={name:this.formGroups.name,description:this.formGroups.desc,users:this.formGroups.users};this.$store.dispatch("group/addGroups",a).then(function(e){e.result?(t.search(),t.$message({type:"success",message:"新建成功"})):t.$message({type:"error",message:"新建失败"})}).catch(function(){t.$message({type:"info",message:"接口调用失败"})})}else if("edit"==this.dialogAction){this.rightDataId=this.rightData.map(function(e){return e.id}),this.formGroups.users=this.rightDataId;var i=this.formGroups;this.$store.dispatch("group/editGroups",i).then(function(e){e.result?(t.search(),t.$message({type:"success",message:"编辑成功"})):t.$message({type:"error",message:"编辑失败"})}).catch(function(){t.$message({type:"info",message:"接口调用失败"})})}this.$refs.newEdit.cancel()},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={id:e.row.id};t.$store.dispatch("group/deleteGroups",a).then(function(e){e.result?(t.search(),t.$message({type:"success",message:"删除成功"})):t.$message({type:"error",message:"删除失败"})})}).catch(function(){t.$message({type:"info",message:"已取消"})})},getLeftUser:function(){var e=this;this.$store.dispatch("group/getAllUser").then(function(t){t.result&&("new"==e.dialogAction?e.leftData=t.data:"edit"==e.dialogAction&&(e.leftData=t.data.filter(function(t){var a=!0,i=!1,n=void 0;try{for(var o,r=s()(e.rightData);!(a=(o=r.next()).done);a=!0){var l=o.value;if(t.id==l.id)return!1}}catch(e){i=!0,n=e}finally{try{!a&&r.return&&r.return()}finally{if(i)throw n}}return!0})))})},turnRightItems:function(){this.rightData.push.apply(this.rightData,this.cacheLeftData);var e=0,t=!0,a=!1,i=void 0;try{for(var n,o=s()(this.cacheLeftData);!(t=(n=o.next()).done);t=!0){var r=n.value;this.leftData.splice(r.rowIndex-e,1),e++}}catch(e){a=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw i}}this.cacheLeftData=[]},turnLeftItems:function(){this.leftData.push.apply(this.leftData,this.cacheRightData);var e=0,t=!0,a=!1,i=void 0;try{for(var n,o=s()(this.cacheRightData);!(t=(n=o.next()).done);t=!0){var r=n.value;this.rightData.splice(r.indexRight-e,1),e++}}catch(e){a=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw i}}this.cacheRightData=[]},handleLeftChange:function(e){this.cacheLeftData=e},handleRightChange:function(e){this.cacheRightData=e},leftRow:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a},rightRow:function(e){var t=e.row,a=e.rowIndex;t.rowIndex=a}},computed:{leftButtonColor:function(){return 0!=this.leftData.length},rightButtonColor:function(){return 0!=this.rightData.length}}}),p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"group"},[a("div",{staticClass:"search"},[a("el-row",[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"aglin"},[e._v("角色名：")]),e._v(" "),a("el-input",{staticClass:"aglin-input",attrs:{size:"mini",clearable:"",placeholder:"请输入内容"},model:{value:e.inputGroup,callback:function(t){e.inputGroup=t},expression:"inputGroup"}})],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"aglin"},[e._v("是否内置：")]),e._v(" "),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:e.valueIsBuiltIn,callback:function(t){e.valueIsBuiltIn=t},expression:"valueIsBuiltIn"}},e._l(e.optionsIsBuiltIn,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("span",{staticClass:"aglin"},[e._v("是否启用：")]),e._v(" "),a("el-select",{attrs:{size:"mini",clearable:"",placeholder:"请选择"},model:{value:e.valueIsEnable,callback:function(t){e.valueIsEnable=t},expression:"valueIsEnable"}},e._l(e.optionsIsEnable,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-button",{attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.search(t)}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{size:"mini"},nativeOn:{click:function(t){return e.reset(t)}}},[e._v("重置")])],1)],1)],1),e._v(" "),a("div",{staticClass:"new"},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleNew}},[e._v("新建角色")])],1),e._v(" "),a("div",{staticClass:"table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingGroup,expression:"loadingGroup"}],ref:"",staticStyle:{width:"100%"},attrs:{stripe:"",data:e.data,height:"100%"}},[a("el-table-column",{attrs:{prop:"name",label:"组名","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"display_name",label:"显示名","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{label:"是否内置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(0==t.is_built_in?"否":"是"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"是否启用"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-checkbox",{on:{change:function(a){e.checkboxChange(t.row)}},model:{value:t.row.is_enable,callback:function(a){e.$set(t.row,"is_enable",a)},expression:"scope.row.is_enable"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"操作",fixed:"right",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleEdit(t)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleAuthority({name:"permission",params:{group_id:t.row.id}})}}},[e._v("权限")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.handleDelete(t)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("pagination",{attrs:{total:e.totalNumber},on:{"page-size-change":e.pageSizeChange}}),e._v(" "),a("new-edit",{ref:"newEdit",attrs:{title:e.title,"dialog-action":"dialogAction",width:e.width},on:{"handle-success":e.handleSuccess}},[a("div",{attrs:{slot:"dialog-content"},slot:"dialog-content"},[a("el-tabs",{attrs:{"before-leave":e.leaveTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"角色信息",name:"first"}},[a("el-form",{ref:"refformGroups",attrs:{"label-position":e.labelPosition,"label-width":"120px",model:e.formGroups,rules:e.rulesGroups}},[a("el-form-item",{attrs:{label:"组名",prop:"name"}},[a("el-input",{staticClass:"form-content",attrs:{size:"mini"},model:{value:e.formGroups.name,callback:function(t){e.$set(e.formGroups,"name",t)},expression:"formGroups.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"显示名",prop:"display_name"}},[a("el-input",{staticClass:"form-content",attrs:{size:"mini"},model:{value:e.formGroups.display_name,callback:function(t){e.$set(e.formGroups,"display_name",t)},expression:"formGroups.display_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{staticClass:"form-content",attrs:{type:"textarea"},model:{value:e.formGroups.desc,callback:function(t){e.$set(e.formGroups,"desc",t)},expression:"formGroups.desc"}})],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"分配用户",name:"second"}},[a("div",[a("el-row",[a("el-col",{attrs:{span:10}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingLeft,expression:"loadingLeft"}],staticStyle:{width:"100%","margin-bottom":"0px"},attrs:{data:e.leftData,border:"",height:"280","row-class-name":e.leftRow},on:{"selection-change":e.handleLeftChange}},[a("el-table-column",{attrs:{type:"selection",prop:"value"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"chname",label:"中文名","show-overflow-tooltip":""}})],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticStyle:{"margin-top":"100%","margin-left":"25%","margin-right":"25%"}},[e.leftButtonColor?a("el-button",{attrs:{size:"mini",type:"primary",icon:"icon el-icon-d-arrow-right"},on:{click:e.turnRightItems}}):e._e(),e._v(" "),e.leftButtonColor?e._e():a("el-button",{attrs:{type:"info",disabled:"",size:"mini",icon:"icon el-icon-d-arrow-right"}}),e._v(" "),e.rightButtonColor?a("el-button",{staticStyle:{margin:"5px 0 0 0"},attrs:{size:"mini",type:"primary",icon:"icon el-icon-d-arrow-left"},on:{click:e.turnLeftItems}}):e._e(),e._v(" "),e.rightButtonColor?e._e():a("el-button",{staticClass:"not-have",staticStyle:{margin:"5px 0 0 0"},attrs:{type:"info",disabled:"",size:"mini",icon:"icon el-icon-d-arrow-left"}})],1)]),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingRight,expression:"loadingRight"}],staticStyle:{width:"100%","margin-bottom":"0px"},attrs:{data:e.rightData,height:"280",border:"","row-class-name":e.rightRow},on:{"selection-change":e.handleRightChange}},[a("el-table-column",{attrs:{type:"selection",prop:"value"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户名",prop:"username"}}),e._v(" "),a("el-table-column",{attrs:{prop:"chname",label:"中文名","show-overflow-tooltip":""}})],1)],1)],1)],1)])],1)],1)])],1)},staticRenderFns:[]};var h=a("VU/8")(u,p,!1,function(e){a("igjK")},null,null);t.default=h.exports}});
//# sourceMappingURL=11.js.map