{"version":3,"sources":["webpack:///src/pages/group_page/Permission.vue","webpack:///./src/pages/group_page/Permission.vue?e051","webpack:///./src/pages/group_page/Permission.vue"],"names":["Permission","data","checked","activeName","dataMenuTree","haveMenuAuthority","checkeditem","allOperations","defaultMenuProps","children","label","created","this","menuAuthority","getPerm","methods","allMenu","_this","$store","dispatch","then","res","result","haveMenu","_this2","params","id","$route","group_id","menus","map","item","_this3","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","promise_default","all","stop","_this4","param","checkConfirm","_this5","menuList","$refs","tree","getCheckedNodes","permIdList","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","get_iterator_default","done","i","value","length","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","j","has_perms","push","err","return","permissions","$message","type","message","group_page_Permission","render","_vm","_h","$createElement","_c","_self","staticClass","model","callback","$$v","expression","attrs","name","ref","show-checkbox","default-expand-all","node-key","highlight-current","default-checked-keys","props","_v","_l","index","key","_s","display_name","itemOperation","indexOperations","$set","size","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"assets/js/16.js","sourcesContent":["<template>\n  <div class=\"permission\">\n    <div class=\"contain\">\n      <el-tabs v-model=\"activeName\" >\n        <el-tab-pane label=\"菜单权限\" name=\"first\">\n          <el-tree\n            :data=\"dataMenuTree\"\n            show-checkbox\n            default-expand-all\n            node-key=\"id\"\n            ref=\"tree\"\n            highlight-current\n            :default-checked-keys=\"haveMenuAuthority\"\n            :props=\"defaultMenuProps\">\n          </el-tree>\n        </el-tab-pane>\n        <el-tab-pane label=\"操作权限\" name=\"second\">\n          <div class=\"one-layer\" v-for=\"(item, index) in allOperations\" :key=\"index\">\n            <span class=\"one-layer-name\">{{item.display_name}}</span>\n            <el-checkbox\n            v-for=\"(itemOperation, indexOperations) in item.children\"\n            :key=\"indexOperations\"\n            v-model=\"itemOperation.has_perms\">\n              {{itemOperation.display_name}}\n            </el-checkbox>\n          </div>\n        </el-tab-pane>\n        <div class=\"check-confirm\">\n          <el-button type=\"primary\" size=\"mini\" @click=\"checkConfirm\">保存</el-button>\n        </div>\n      </el-tabs>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      checked: [],\n      activeName: 'first',\n      dataMenuTree: [],\n      haveMenuAuthority: [],\n      checkeditem: [], // 勾选的操作\n      allOperations: [], // 所有操作\n      defaultMenuProps: {\n        children: 'children',\n        label: 'display_name'\n      },\n    }\n  },\n  created() {\n    this.menuAuthority()\n    this.getPerm()\n  },\n  methods: {\n    // 所有菜单数据\n    allMenu() {\n      this.dataMenuTree = []\n      return this.$store.dispatch('leftmenu/getMenuTree').then(res => {\n        if (res.result) {\n          this.dataMenuTree = res.data\n        }\n      })\n    },\n    // 已有菜单权限\n    haveMenu() {\n      this.haveMenuAuthority = []\n      let params = {\n        id: this.$route.params.group_id\n      }\n      return this.$store.dispatch('group/getAuthority', params).then(res => {\n        if (res.result) {\n          this.haveMenuAuthority = res.data.menus.map(item => item.id)\n        }\n      })\n    },\n    // 树状菜单数据\n    async menuAuthority(id) {\n      await Promise.all([\n        this.allMenu(),\n        this.haveMenu(id)\n      ])\n    },\n    // 操作权限数据\n    getPerm() {\n      this.allOperations = []\n      let param = {id: this.$route.params.group_id}\n      this.$store.dispatch('group/getPermsTree', param).then(res => {\n        if (res.result) {\n          this.allOperations = res.data\n        }\n      })\n    },\n    // 确认操作权限\n    checkConfirm() {\n      // 菜单权限id数组\n      let menuList = this.$refs.tree.getCheckedNodes()\n      menuList = menuList.map(item => item.id)\n      // 操作功能权限id数组\n      let permIdList = []\n      for (let i of this.allOperations) {\n        if (i.children.length !== 0) {\n          for (let j of i.children) {\n            if (j.has_perms == true) {\n              permIdList.push(j.id)\n            }\n          }\n        }\n      }\n      let params = {\n        id: this.$route.params.group_id,\n        permissions: permIdList,\n        menus: menuList,\n      }\n      this.$store.dispatch('group/editGroups', params).then(res => {\n        if (res.result) {\n          this.$message({type: 'success', message: '权限设置成功'})\n        } else {\n          this.getPerm()\n          this.$message({type: 'error', message: '权限设置失败'})\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .permission {\n    height: 100%;\n    width: 100%;\n    .contain {\n      height: 100%;\n      padding: 15px 20px 0 20px;\n      background: #fff;\n      .check-confirm {\n        padding: 20px;\n        position: absolute;\n        bottom: 0;\n      }\n      .el-tabs.el-tabs--top {\n        height: 100%;\n        .el-tabs__content {\n          height: calc(100% - 55px);\n          .el-tab-pane {\n            height: 100%;\n            .one-layer {\n              padding: 20px;\n              border-bottom: 1px solid #f1eded;\n              .one-layer-name {\n                display: block;\n                font-size: 1.5em;\n                margin-bottom: 20px;\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/group_page/Permission.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"permission\"},[_c('div',{staticClass:\"contain\"},[_c('el-tabs',{model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"菜单权限\",\"name\":\"first\"}},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.dataMenuTree,\"show-checkbox\":\"\",\"default-expand-all\":\"\",\"node-key\":\"id\",\"highlight-current\":\"\",\"default-checked-keys\":_vm.haveMenuAuthority,\"props\":_vm.defaultMenuProps}})],1),_vm._v(\" \"),_c('el-tab-pane',{attrs:{\"label\":\"操作权限\",\"name\":\"second\"}},_vm._l((_vm.allOperations),function(item,index){return _c('div',{key:index,staticClass:\"one-layer\"},[_c('span',{staticClass:\"one-layer-name\"},[_vm._v(_vm._s(item.display_name))]),_vm._v(\" \"),_vm._l((item.children),function(itemOperation,indexOperations){return _c('el-checkbox',{key:indexOperations,model:{value:(itemOperation.has_perms),callback:function ($$v) {_vm.$set(itemOperation, \"has_perms\", $$v)},expression:\"itemOperation.has_perms\"}},[_vm._v(\"\\n            \"+_vm._s(itemOperation.display_name)+\"\\n          \")])})],2)})),_vm._v(\" \"),_c('div',{staticClass:\"check-confirm\"},[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.checkConfirm}},[_vm._v(\"保存\")])],1)],1)],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-006918c5\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/group_page/Permission.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-006918c5\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Permission.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Permission.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Permission.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-006918c5\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Permission.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/group_page/Permission.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}